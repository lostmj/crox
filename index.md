---
layout: post
title: Crox
---

## 综述

Crox是一个由JavaScript语言实现的高性能跨语言模板引擎。

Crox模板可以直接在JavaScript环境中使用，也可以翻译成PHP、JSP等其他编程语言的可执行方法，或翻译成Velocity、Smarty等其他模板引擎的源模板。

Crox将保证翻译后的结果具备最佳执行效率。

* 版本：1.1
* 作者：三冰，李牧，思竹，陆辉，思霏

## 使用Crox之前的准备知识

### 1 为什么“又”做一个模板引擎

全端时代的展现端多样化迫使后端服务纯数据化改造进程加快，而在前端领域依靠前端构造展现的WebAPP架构与后台输出展现的传统架构将长期共存。在此背景下一个能够在多种架构环境中广泛适用的跨语言模板引擎将带给我们:

* 不同Web架构间从数据到HTML的构建过程的统一，这样：
  * 不同架构间的前端组件和区块可以共享复用
  * 前端工程师改开发Demo为开发模板，降低“套页面”引入的质量风险
* 促成新型的同时支持前后端渲染的前端架构，可以：
  * 解决单页应用站点内容无法被搜索引擎抓取的问题
  * 让移动端在省电模式（高网速后台渲染）和省流量模式（低网速前台渲染）中灵活切换成为可能
* 基于语法、词法分析的模板引擎将有助于区块内基于数据变化进行局部刷新的技术实现

### 2 高性能是跨语言模板引擎能够广泛应用的前提

“高性能”是跨语言全端模板引擎的核心技术指标。因为无论在动辄数千QPS的后端环境下，还是在展现伴随着内存和电力消耗的移动端，模板引擎的性能要求都比在PC端分布式运行的环境里高出太多。那么如何做到高性能呢？

#### 2.1 通过逻辑“直译”保障高效

看一个例子：

![Crox Example](http://strip.taobaocdn.com/tfscom/T1anY3Fc8cXXb1upjX.jpg)

从这个例子可以看出，无论JavaScript还是Php，翻译后代码和大家读模板时直观印象一致，每个位置输出的数据十分明确，遇到判断就是一个判断。这就是Crox强调的逻辑“直译”，它让我们明确每一行代码的性能消耗都是充分和必要的.

#### 2.2 通过明确的API定义保障逻辑"直译"可行
在Crox中我们通过明确的API设计和严格的功能取舍来确保“直译”可行。下面是Crox基础API设计原则：

* 除了在循环中,所有待输出数据需要写出完整的从root开始的路径
* 支持并且明确的区分分支语句和循环语句
* 在循环语句中需要显式指定临时变量，用于指代循环时的当前元素和index
* 仅支持简单的赋值表达式和运算表达式
* 支持子模板引入
* 仅支持以上所述功能

## 目录

- [快速上手](./tutorials)
- [Demos](./demos)
- [API介绍](./apis)
- [文章](./articles)
- [相关资源](./resources)
- [常见问题与回答](./faq)
- [发布记录](./releases)
