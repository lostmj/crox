/*
 Crox v1.2.0
 https://github.com/thx/crox

 Released under the MIT license
 md5: 85cc6a80cafdc4e8499b13a021b01fd3
*/
(function(A){var y=function(){function y(a,h){this.row=a;this.col=h}function D(a,h){var d=a.substring(0,h),e=d.match(/\r\n?|\n/g),c=1;e&&(c+=e.length);d=1+/[^\r\n]*$/.exec(d)[0].length;return new y(c,d)}function A(a){return'"'+a.replace(/[\x00-\x1f"\\\u2028\u2029]/g,function(h){switch(h){case '"':return'\\"';case "\\":return"\\\\";case "\b":return"\\b";case "\f":return"\\f";case "\n":return"\\n";case "\r":return"\\r";case "\t":return"\\t"}return"\\u"+("000"+h.charCodeAt(0).toString(16)).slice(-4)})+
'"'}function G(a){function h(c,b,g,e){this.tag=c;this.text=b;this.index=g;this.subMatches=e}function d(){}function e(c){for(var b=1,g=[],e=[1],h=[],a=0;a<c.length;++a)e.push(b+=RegExp("|"+c[a][0].source).exec("").length),h.push(c[a][1]||d),g.push("("+c[a][0].source+")");return[RegExp(g.join("|")+"|","g"),e,h]}h.prototype.toString=function(){return this.text};var c=a.$||"$",f={},g;for(g in a)"$"!=g.charAt(0)&&(f[g]=e(a[g]));return function(g){var b=g.length,e=0,a=[""],d={text:"",index:0,source:g,pushState:function(b){a.push(b)},
popState:function(){a.pop()},retract:function(b){e-=b}};return{scan:function(){do{var r;a:{var q=f[a[a.length-1]],m=q[0];m.lastIndex=e;r=m.exec(g);if(""==r[0]){if(e<b)throw Error("lexer error: "+D(g,e)+"\n"+g.slice(e,e+50));r=new h(c,"",e)}else{d.index=e;e=m.lastIndex;for(var m=q[1],p=0;p<m.length;++p)if(r[m[p]]){q=q[2][p].apply(d,r.slice(m[p],m[p+1]));r=new h(q,r[0],d.index,r.slice(m[p]+1,m[p+1]));break a}r=void 0}}}while(null==r.tag);return r},getPos:function(b){return D(g,b)},reset:function(){e=
0;a=[""]}}}}function u(a){var h;a:{switch(a){case "id":case "lit":h=!0;break a}h=!1}return h||"."==a||"[]"==a}function l(a){return u(a)||"!"==a||"u-"==a}function v(a){if(l(a))return!0;switch(a){case "*":case "/":case "%":return!0}return!1}function w(a){if(v(a))return!0;switch(a){case "+":case "-":return!0}return!1}function x(a){if(w(a))return!0;switch(a){case "<":case ">":case "<=":case ">=":return!0}return!1}function z(a){if(x(a))return!0;switch(a){case "eq":case "ne":return!0}return!1}function B(a){return z(a)||
"&&"==a}function E(a){return B(a)||"||"==a}function H(a,h){function d(b){k+=g+b+"\n"}function e(b){for(var c=0;c<b.length;++c){var a=b[c];switch(a[0]){case "if":d("if("+f(a[1])+"){");g+="\t";e(a[2]);g=g.slice(0,-1);d("}");a[3]&&(d("else{"),g+="\t",e(a[3]),g=g.slice(0,-1),d("}"));break;case "each":var k=a[3]||"$i";d("var $list = "+f(a[1])+";");d("for(var "+k+" in $list) {");g+="\t";d("var "+a[4]+" = $list["+k+"];");e(a[2]);g=g.slice(0,-1);d("}");break;case "set":d("var "+a[1]+"="+f(a[2])+";");break;
case "eval":k=f(a[1]);a[2]&&(k=h+"("+k+")");d("$s += "+k+";");break;case "text":d("$s += "+A(a[1])+";");break;case "inc":break;default:throw Error("unknown stmt: "+a[0]);}}}function c(b,c){var g=f(b);c&&!c(b[0])&&(g="("+g+")");return g}function f(b){switch(b[0]){case "id":return b[1];case "lit":return"string"==typeof b[1]?A(b[1]):String(b[1]);case ".":return c(b[1],u)+"."+b[2];case "[]":return c(b[1],u)+"["+f(b[2])+"]";case "!":return"!"+c(b[1],l);case "u-":return"- "+c(b[1],l);case "*":case "/":case "%":return c(b[1],
v)+b[0]+c(b[2],l);case "+":case "-":return c(b[1],w)+b[0]+" "+c(b[2],v);case "<":case ">":case "<=":case ">=":return c(b[1],x)+b[0]+c(b[2],w);case "eq":case "ne":return c(b[1],z)+("eq"==b[0]?"===":"!==")+c(b[2],x);case "&&":return c(b[1],B)+"&&"+c(b[2],z);case "||":return c(b[1],E)+"||"+c(b[2],B);default:throw Error("unknown expr: "+b[0]);}}var g="\t",k="";e(a[1]);return k}function C(a){return I(J(a))}function F(a,h){var d=C(a),e;h&&(e=h.htmlEncode);var d=H(d,e||"$htmlEncode"),c="";e||(c+="var obj = { '<': '&lt;', '>': '&gt;', '&': '&amp;', '\"': '&quot;' };\n\tfunction $htmlEncode(s) {\n\t\treturn String(s).replace(/[<>&\"]/g, function(c) {\n\t\t\treturn obj[c];\n\t\t});\n\t}");
c=c+"var $s = '';"+d;c+="return $s;";return Function("root",c)}function K(a){function h(){g=g.substr(0,g.length-2)}function d(b){k+=g+b+"\n"}function e(b){for(var c=0;c<b.length;++c){var a=b[c];switch(a[0]){case "if":d("if("+f(a[1])+"){");g+="  ";e(a[2]);h();d("}");a[3]&&(d("else{"),g+="  ",e(a[3]),h(),d("}"));break;case "each":var k=a[3]?"$crox_"+a[3]+"=>":"";d("foreach("+f(a[1])+" as "+k+"$crox_"+a[4]+")");d("{");g+="  ";e(a[2]);h();d("}");break;case "set":d("$crox_"+a[1]+" = "+f(a[2])+";");break;
case "eval":k=f(a[1]);k=a[2]?"crox_encode("+k+")":"crox_ToString("+k+")";d("echo "+k+";");break;case "text":d("echo "+("'"+String(a[1]).replace(/['\\]/g,"\\$&")+"'")+";");break;case "inc":break;default:throw Error("unknown stmt: "+a[0]);}}}function c(b,a){var c=f(b);a&&!a(b[0])&&(c="("+c+")");return c}function f(b){switch(b[0]){case "id":return"$crox_"+b[1];case "lit":return"string"==typeof b[1]?"'"+String(b[1]).replace(/['\\]/g,"\\$&")+"'":String(b[1]);case ".":return c(b[1],u)+"->"+b[2];case "[]":return c(b[1],
u)+"["+f(b[2])+"]";case "!":return"!crox_ToBoolean("+c(b[1],l)+")";case "u-":return"- "+c(b[1],l);case "*":case "/":case "%":return c(b[1],v)+b[0]+c(b[2],l);case "+":return"crox_plus("+c(b[1],null)+", "+c(b[2],null)+")";case "-":return c(b[1],w)+"- "+c(b[2],v);case "<":case ">":case "<=":case ">=":return c(b[1],x)+b[0]+c(b[2],w);case "eq":case "ne":var a="eq"==b[0]?"===":"!==";return c(b[1],z)+a+c(b[2],x);case "&&":return"crox_logical_and("+c(b[1],null)+", "+c(b[2],null)+")";case "||":return"crox_logical_or("+
c(b[1],null)+", "+c(b[2],null)+")";default:throw Error("unknown expr: "+b[0]);}}var g="",k="";e(a[1]);return k}function L(a,h){function d(a){for(var e=0;e<a.length;++e){var b=a[e];switch(b[0]){case "if":var h="#if("+c(b[1])+")";f+=h;d(b[2]);b[3]&&(f+="#{else}",d(b[3]));f+="#{end}";break;case "each":var h=b[3]?"$_"+b[3]:"$k",l="#set ($list = "+c(b[1])+")";f+=l;f+="#foreach($_"+b[4]+" in $list)";b[3]&&(f+="#set("+h+" = $velocityCount - 1)");d(b[2]);f+="#{end}";break;case "set":b="#set ($_"+b[1]+"="+
c(b[2])+")";f+=b;break;case "eval":b=c(b[1]);f=/^\$([\w-]+)$/.test(b)?f+("${"+RegExp.$1+"}"):f+("#set($t = "+b+")$!{t}");break;case "text":b=b[1].replace(/\$/g,"$${dollar}").replace(/#/g,"$${sharp}");f+=b;break;case "inc":b="#parse('"+b[1].replace(/\.\w+$/,".vm")+"')";f+=b;break;default:throw Error("unknown stmt: "+b[0]);}}}function e(a,e){var b=c(a);e&&!e(a[0])&&(b="("+b+")");return b}function c(a){switch(a[0]){case "id":return"$_"+a[1];case "lit":return"string"==typeof a[1]?(a=a[1],a=-1==a.indexOf("'")?
"'"+a+"'":"('"+a.split("'").join("'+\"'\"+'")+"')",a):String(a[1]);case ".":return e(a[1],u)+"."+a[2];case "[]":return e(a[1],u)+"["+c(a[2])+"]";case "!":return"!"+e(a[1],l);case "u-":if("u-"==a[1][0])throw Error("\u7981\u6b62\u4e24\u4e2a\u8d1f\u53f7\u8fde\u7528");return"-"+e(a[1],l);case "*":case "/":case "%":return e(a[1],v)+a[0]+e(a[2],l);case "+":case "-":return e(a[1],w)+a[0]+" "+e(a[2],v);case "<":case ">":case "<=":case ">=":return e(a[1],x)+a[0]+e(a[2],w);case "eq":case "ne":return e(a[1],
z)+("eq"==a[0]?"==":"!=")+e(a[2],x);case "&&":return e(a[1],B)+"&&"+e(a[2],z);case "||":return e(a[1],E)+"||"+e(a[2],B);default:throw Error("unknown expr: "+a[0]);}}h||(h="\r\n");var f="#set($dollar='$')#set($sharp='#')";d(a[1]);return f}y.prototype.toString=function(){return"("+this.row+","+this.col+")"};var J=function(){var a=[[/\s+/,function(){return null}],[/[A-Za-z_]\w*/,function(a){switch(a){case "true":case "false":return"boolean";case "set":case "include":return a;default:if(-1!=" abstract boolean break byte case catch char class const continue debugger default delete do double else enum export extends final finally float for function goto if implements import in instanceof int interface let long native new package private protected public return short static super switch synchronized this throw throws transient try typeof var void volatile while with yield ".indexOf(" "+
a+" ")||"null"==a)throw Error("Reserved: "+a+" "+D(this.source,this.index));return"realId"}}],[/"(?:[^"\\]|\\[\s\S])*"|'(?:[^'\\]|\\[\s\S])*'/,function(a){return"string"}],[/\d+(?:\.\d+)?(?:e-?\d+)?/,function(a){return"number"}],[function(a){a.sort().reverse();for(var d=0;d<a.length;++d)a[d]=a[d].replace(/[()*+?.[\]|]/g,"\\$&");return RegExp(a.join("|"))}("! % && ( ) * + - . / < <= = > >= [ ] || === !==".split(" ")),function(a){switch(a){case "===":return"eq";case "!==":return"ne";default:return a}}]];
return G({"":[[/(?:(?!{{)[\s\S])+/,function(a){return"{{"==a.substring(0,2)?(this.pushState(a),a):"text"}],[/{{{/,function(a){this.pushState(a);return a}],[/{{(?:\/if|else|\/each)}}/,function(a){return a}],[/{{(?:#(?:if|each)(?=\s))?/,function(a){this.pushState("{{");return a}]],"{{":a.concat([[/}}/,function(a){this.popState();return a}]]),"{{{":a.concat([[/}}}/,function(a){this.popState();return a}]])})}(),I=function(){return function(a){function h(a,b){return f[a][b]}var d=a.nStart,e=a.tSymbols,
c=a.tSymbolIndex,f=a.tAction,g=a.tGoto,k=a.tRules,b=a.tFuncs,l=a.actionIndex;l&&(h=function(a,b){var c=f[l[a]];return c[b]||c._});return function(a,f){function l(b){throw Error("Syntax error: "+a.getPos(p.index)+(b?"\n"+b:""));}var q=0,m=[0],p=a.scan(),s=[],u={get:function(a){return s[s.length+a]},set:function(a,b){s[s.length+a]=b}};if(f)for(var n in f)u[n]=f[n];for(;;)if(n=h(q,c[p.tag]))if(0<n)m.push(q=n),s.push(p),p=a.scan();else if(0>n&&-32768<n){n=-n;var q=k[n],t=q.length-1;m.length-=t;q=g[m[m.length-
1]][q[0]-d];m.push(q);b[n]?(n=b[n].apply(u,s.splice(s.length-t,t)),s.push(n)):1!=t&&s.splice(s.length-t,t,null)}else return p.tag!=e[0]&&l(),s[0];else{n=[];for(t=0;t<d;++t)h(q,t)&&n.push(e[t]);l("find "+p.tag+"\nexpect "+n.join(" "))}}}({nStart:37,tSymbols:"$ ! % && ( ) * + - . / < <= = > >= [ ] boolean eq include ne number realId set string text {{ {{#each {{#if {{/each}} {{/if}} {{else}} {{{ || }} }}} AdditiveExpression EqualityExpression LogicalAndExpression LogicalOrExpression MemberExpression MultiplicativeExpression PrimaryExpression RelationalExpression UnaryExpression epsilon expr id program statement statements".split(" "),
tSymbolIndex:{$:0,"!":1,"%":2,"&&":3,"(":4,")":5,"*":6,"+":7,"-":8,".":9,"/":10,"<":11,"<=":12,"=":13,">":14,">=":15,"[":16,"]":17,"boolean":18,eq:19,include:20,ne:21,number:22,realId:23,set:24,string:25,text:26,"{{":27,"{{#each":28,"{{#if":29,"{{/each}}":30,"{{/if}}":31,"{{else}}":32,"{{{":33,"||":34,"}}":35,"}}}":36,AdditiveExpression:37,EqualityExpression:38,LogicalAndExpression:39,LogicalOrExpression:40,MemberExpression:41,MultiplicativeExpression:42,PrimaryExpression:43,RelationalExpression:44,
UnaryExpression:45,epsilon:46,expr:47,id:48,program:49,statement:50,statements:51},tAction:[{_:-2},{_:-32768},{26:3,27:4,28:5,29:6,33:7,_:-1},{_:-11},{1:9,4:10,8:11,18:12,20:13,22:14,23:15,24:16,25:17,_:0},{1:9,4:10,8:11,18:12,20:29,22:14,23:15,24:30,25:17,_:0},{_:-3},{_:-18},{25:37,_:-15},{_:-17},{_:-13},{20:29,23:15,24:30,_:-14},{_:-16},{7:39,8:40,_:-34},{19:41,21:42,_:-42},{3:43,_:-44},{34:44,_:-46},{9:45,16:46,_:-24},{2:47,6:48,10:49,_:-31},{_:-21},{11:50,12:51,14:52,15:53,_:-39},{_:-27},{35:54,
_:0},{_:-19},{_:-15},{_:-14},{25:55,_:0},{35:56,_:0},{36:57,_:0},{_:-25},{5:58,_:0},{_:-26},{35:59,_:0},{13:60,_:0},{20:29,23:15,24:30,_:0},{_:-9},{25:76,_:-47},{_:-10},{_:-20},{_:-12},{2:47,6:48,10:49,_:-32},{2:47,6:48,10:49,_:-33},{11:50,12:51,14:52,15:53,_:-40},{11:50,12:51,14:52,15:53,_:-41},{19:41,21:42,_:-43},{3:43,_:-45},{_:-22},{17:80,_:0},{_:-30},{_:-28},{_:-29},{7:39,8:40,_:-35},{7:39,8:40,_:-37},{7:39,8:40,_:-36},{7:39,8:40,_:-38},{35:81,_:0},{35:82,_:0},{26:3,27:4,28:5,29:6,31:83,32:84,
33:7,_:0},{35:85,_:0},{_:-23},{_:-4},{_:-8},{26:3,27:4,28:5,29:6,30:89,33:7,_:0},{26:3,27:4,28:5,29:6,30:90,33:7,_:0},{26:3,27:4,28:5,29:6,31:91,33:7,_:0},{_:-7},{_:-6},{_:-5}],actionIndex:[0,1,2,3,4,5,5,5,6,5,5,5,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,5,5,5,5,5,5,34,5,5,5,5,5,5,5,5,35,36,0,37,38,39,5,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,0,0,60,0,61,62,63,64,65,66,67],tGoto:[{12:1,14:2},,{13:8},,{0:18,1:19,2:20,3:21,4:22,5:23,6:24,7:25,
8:26,10:27,11:28},{0:18,1:19,2:20,3:21,4:22,5:23,6:24,7:25,8:26,10:31,11:28},{0:18,1:19,2:20,3:21,4:22,5:23,6:24,7:25,8:26,10:32,11:28},{0:18,1:19,2:20,3:21,4:22,5:23,6:24,7:25,8:26,10:33,11:28},,{4:22,6:24,8:34,11:28},{0:18,1:19,2:20,3:21,4:22,5:23,6:24,7:25,8:26,10:35,11:28},{4:22,6:24,8:36,11:28},,,,,{11:38},,,,,,,,,,,,,,,,,,,,,,,{4:22,5:61,6:24,8:26,11:28},{4:22,5:62,6:24,8:26,11:28},{0:18,4:22,5:23,6:24,7:63,8:26,11:28},{0:18,4:22,5:23,6:24,7:64,8:26,11:28},{0:18,1:65,4:22,5:23,6:24,7:25,8:26,
11:28},{0:18,1:19,2:66,4:22,5:23,6:24,7:25,8:26,11:28},{11:67},{0:18,1:19,2:20,3:21,4:22,5:23,6:24,7:25,8:26,10:68,11:28},{4:22,6:24,8:69,11:28},{4:22,6:24,8:70,11:28},{4:22,6:24,8:71,11:28},{0:72,4:22,5:23,6:24,8:26,11:28},{0:73,4:22,5:23,6:24,8:26,11:28},{0:74,4:22,5:23,6:24,8:26,11:28},{0:75,4:22,5:23,6:24,8:26,11:28},,{9:77},{14:78},,,,{0:18,1:19,2:20,3:21,4:22,5:23,6:24,7:25,8:26,10:79,11:28},,,,,,,,,,,,,,,,,,{13:8},,,{14:86},{14:87},,{14:88},,{13:8},{13:8},{13:8}],tRules:[[52,49],[49,51],[51],
[51,51,50],[50,29,47,35,51,31],[50,29,47,35,51,32,51,31],[50,28,47,25,46,35,51,30],[50,28,47,25,25,35,51,30],[50,27,24,48,13,47,35],[50,27,47,35],[50,33,47,36],[50,26],[50,27,20,25,35],[48,23],[48,24],[48,20],[43,25],[43,22],[43,18],[43,48],[43,4,47,5],[41,43],[41,41,9,48],[41,41,16,47,17],[45,41],[45,1,45],[45,8,45],[42,45],[42,42,6,45],[42,42,10,45],[42,42,2,45],[37,42],[37,37,7,42],[37,37,8,42],[44,37],[44,44,11,37],[44,44,14,37],[44,44,12,37],[44,44,15,37],[38,44],[38,38,19,44],[38,38,21,44],
[39,38],[39,39,3,38],[40,39],[40,40,34,39],[47,40],[46]],tFuncs:function(){function a(a,c,f,d,h,b,l){return["each",c,b,d&&eval(d.text),eval(f.text)]}function h(a){return["lit",eval(a.text)]}function d(a,c,f){return[c.text,a,f]}return[,function(a){return["prog",a]},function(){return[]},function(a,c){a.push(c);return a},function(a,c,f,d,h){return["if",c,d]},function(a,c,f,d,h,b,l){return["if",c,d,b]},a,a,function(a,c,d,g,h,b){return["set",d.text,h]},function(a,c,d){return["eval",c,!0]},function(a,c,
d){return["eval",c,!1]},function(a){return["text",a.text]},function(a,c,d,g){return["inc",eval(d.text)]},,,,h,h,function(a){return["lit","true"==a.text]},function(a){return["id",a.text]},function(a,c,d){return c},,function(a,c,d){return[".",a,d.text]},function(a,c,d,g){return["[]",a,d]},,function(a,c){return["!",c]},function(a,c){return["u-",c]},,d,d,d,,d,d,,d,d,d,d,,function(a,c,d){return["eq",a,d]},function(a,c,d){return["ne",a,d]},,d,,d]}()})}();return{parse:C,compile:F,render:function(a,h){return F(a)(h)},
compileToPhp:function(a){return K(C(a))},compileToVM:function(a,h){return L(C(a))},version:"1.2.0"}}();"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=y:"function"==typeof define&&(define.amd||define.cmd)?define(function(){return y}):"undefined"!=typeof KISSY&&KISSY.add("crox",function(){return y});A&&(A.Crox=y)})(this);
