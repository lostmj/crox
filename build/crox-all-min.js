/*
 Crox v1.2.8
 https://github.com/thx/crox

 Released under the MIT license
 md5: 1148cc38533540fc0e33aeaab155c241
*/
(function(C){var A=function(){function A(a,g){this.row=a;this.col=g}function F(a,g){var f=a.substring(0,g),d=f.match(/\r\n?|\n/g),e=1;d&&(e+=d.length);f=1+/[^\r\n]*$/.exec(f)[0].length;return new A(e,f)}function C(a){return'"'+a.replace(/[\x00-\x1f"\\\u2028\u2029]/g,function(g){switch(g){case '"':return'\\"';case "\\":return"\\\\";case "\b":return"\\b";case "\f":return"\\f";case "\n":return"\\n";case "\r":return"\\r";case "\t":return"\\t"}return"\\u"+("000"+g.charCodeAt(0).toString(16)).slice(-4)})+
'"'}function G(a){return eval(a)}function t(a){return a.replace(/^_+/,"$&$&")}function J(a){function g(b,c,k,e){this.tag=b;this.text=c;this.index=k;this.subMatches=e}function f(){}function d(b){for(var c=1,k=[],e=[1],h=[],g=0;g<b.length;++g)e.push(c+=RegExp("|"+b[g][0].source).exec("").length),h.push(b[g][1]||f),k.push("("+b[g][0].source+")");return[RegExp(k.join("|")+"|","g"),e,h]}g.prototype.toString=function(){return this.text};var e=a.$||"$",b={},h;for(h in a)"$"!=h.charAt(0)&&(b[h]=d(a[h]));
return function(h){var c=h.length,k=0,a=[""],d={text:"",index:0,source:h,pushState:function(b){a.push(b)},popState:function(){a.pop()},retract:function(b){k-=b}};return{scan:function(){do{var f;a:{var r=b[a[a.length-1]],l=r[0];l.lastIndex=k;f=l.exec(h);if(""==f[0]){if(k<c)throw Error("lexer error: "+F(h,k)+"\n"+h.slice(k,k+50));f=new g(e,"",k)}else{d.index=k;k=l.lastIndex;for(var l=r[1],q=0;q<l.length;++q)if(f[l[q]]){r=r[2][q].apply(d,f.slice(l[q],l[q+1]));f=new g(r,f[0],d.index,f.slice(l[q]+1,l[q+
1]));break a}f=void 0}}}while(null==f.tag);return f},getPos:function(b){return F(h,b)}}}}function w(a){var g;a:{switch(a){case "id":case "lit":g=!0;break a}g=!1}return g||"."==a||"[]"==a}function m(a){return w(a)||"!"==a||"u-"==a}function x(a){if(m(a))return!0;switch(a){case "*":case "/":case "%":return!0}return!1}function y(a){if(x(a))return!0;switch(a){case "+":case "-":return!0}return!1}function z(a){if(y(a))return!0;switch(a){case "<":case ">":case "<=":case ">=":return!0}return!1}function B(a){if(z(a))return!0;
switch(a){case "eq":case "ne":return!0}return!1}function D(a){return B(a)||"&&"==a}function H(a){return D(a)||"||"==a}function K(a,g,f){function d(b){c+=b}function e(b){for(var c=0;c<b.length;++c){var a=b[c];switch(a[0]){case "if":d("if("+h(a[1])+"){");e(a[2]);d("}");a[3]&&(d("else{"),e(a[3]),d("}"));break;case "each":var p=a[3]?t(a[3]):"_"+s++,r=h(a[1]);if(/^\w+$/.test(r))var l=r;else l="_"+s++,d("var "+l+" = "+r+";");a[5]?d("for(var "+p+"=0;"+p+"<"+l+".length;"+p+"++){"):d("for(var "+p+" in "+l+
") {");d("var "+a[4]+" = "+l+"["+p+"];");e(a[2]);d("}");break;case "set":d("var "+t(a[1])+"="+h(a[2])+";");break;case "eval":p=h(a[1]);/^\w+$/.test(p)?r=p:(r="_t",d("_t = "+p+";"));d("if("+r+" !=null)_s += "+((f?!a[2]:a[2])?g+"("+r+")":r)+";");break;case "text":d("_s += "+C(a[1])+";");break;case "inc":break;default:throw Error("unknown stmt: "+a[0]);}}}function b(b,c){var a=h(b);c&&!c(b[0])&&(a="("+a+")");return a}function h(c){switch(c[0]){case "id":return t(c[1]);case "lit":return"string"==typeof c[1]?
C(c[1]):String(c[1]);case ".":return b(c[1],w)+"."+c[2];case "[]":return b(c[1],w)+"["+h(c[2])+"]";case "()":var a=[];if(c[2])for(var e=0;e<c[2].length;++e)a.push(h(c[2][e]));return b(c[1],w)+"("+a.join(",")+")";case "!":return"!"+b(c[1],m);case "u-":return"- "+b(c[1],m);case "*":case "/":case "%":return b(c[1],x)+c[0]+b(c[2],m);case "+":case "-":return b(c[1],y)+c[0]+" "+b(c[2],x);case "<":case ">":case "<=":case ">=":return b(c[1],z)+c[0]+b(c[2],y);case "==":case "!=":case "===":case "!==":return b(c[1],
B)+c[0]+b(c[2],z);case "&&":return b(c[1],D)+"&&"+b(c[2],B);case "||":return b(c[1],H)+"||"+b(c[2],D);default:throw Error("unknown expr: "+c[0]);}}var s=0,c="";e(a[1]);return c}function E(a){return L(M(a))}function I(a,g){var f=E(a),d;g&&(d=g.htmlEncode);a=K(f,d||"_htmlEncode",!0);f="";d||(f="var _obj = { '<': '&lt;', '>': '&gt;', '&': '&amp;', '\"': '&quot;' };\tfunction _htmlEncode(s) {\t\treturn String(s).replace(/[<>&\"]/g, function(c) {\t\t\treturn _obj[c];\t\t});\t}");return Function("root",
f+("var _t,_s = '';"+a+"return _s;"))}function N(a,g){function f(a){for(var d=0;d<a.length;++d){var c=a[d];switch(c[0]){case "if":var k="if("+e(c[1])+"){";b+=k;f(c[2]);b+="}";c[3]&&(b+="else{",f(c[3]),b+="}");break;case "each":k="foreach("+e(c[1])+" as "+(c[3]?"$crox_"+t(c[3])+"=>":"")+("$crox_"+t(c[4]))+")";b+=k;b+="{";f(c[2]);b+="}";break;case "set":c="$crox_"+t(c[1])+" = "+e(c[2])+";";b+=c;break;case "eval":k=e(c[1]);b+="crox_echo("+k+", "+(g?!c[2]:c[2])+");";break;case "text":k=c[1];/<\?(?:php)?|\?>/.test(k)?
(c="echo "+("'"+String(c[1]).replace(/['\\]/g,"\\$&")+"'")+";",b+=c):b+="?>"+k+"<?php ";break;case "inc":c="include '"+c[1].replace(/\.\w+$/,".php")+"';";b+=c;break;default:throw Error("unknown stmt: "+c[0]);}}}function d(b,a){var c=e(b);a&&!a(b[0])&&(c="("+c+")");return c}function e(b){switch(b[0]){case "id":return"$crox_"+t(b[1]);case "lit":return"string"==typeof b[1]?"'"+String(b[1]).replace(/['\\]/g,"\\$&")+"'":String(b[1]);case ".":return d(b[1],w)+"->"+b[2];case "[]":return d(b[1],w)+"["+e(b[2])+
"]";case "!":return"!crox_ToBoolean("+d(b[1],m)+")";case "u-":return"- "+d(b[1],m);case "*":case "/":case "%":return d(b[1],x)+b[0]+d(b[2],m);case "+":return"crox_plus("+d(b[1],null)+", "+d(b[2],null)+")";case "-":return d(b[1],y)+"- "+d(b[2],x);case "<":case ">":case "<=":case ">=":return d(b[1],z)+b[0]+d(b[2],y);case "==":case "!=":case "===":case "!==":return d(b[1],B)+b[0]+d(b[2],z);case "&&":return"crox_logical_and("+d(b[1],null)+", "+d(b[2],null)+")";case "||":return"crox_logical_or("+d(b[1],
null)+", "+d(b[2],null)+")";default:throw Error("unknown expr: "+b[0]);}}var b="";f(a[1]);b="?>"==b.slice(0,2)?b.slice(2):"<?php "+b;return b="<?php "==b.slice(-6)?b.slice(0,-6):b+"?>"}function O(a){function g(b){return"$crox_"+t(b)}function f(b){s+=b}function d(c){for(var a=0;a<c.length;++a){var e=c[a];switch(e[0]){case "if":f("#if("+b(e[1])+")");d(e[2]);e[3]&&(f("#{else}"),d(e[3]));f("#{end}");break;case "each":++h;var s=b(e[1]);if(/^$\w+$/.test(s))var p=s;else p="$list"+(1==h?"":h),f("#set ("+
p+" = "+s+")");e[5]?(f("#foreach("+g(e[4])+" in "+p+")"),e[3]&&f("#set("+g(e[3])+" = $velocityCount - 1)")):e[3]?(f("#foreach("+g(e[3])+" in "+p+".keySet())"),f("#set("+g(e[4])+" ="+p+".get("+g(e[3])+"))")):f("#foreach("+g(e[4])+" in "+p+")");d(e[2]);f("#{end}");--h;break;case "set":f("#set ("+g(e[1])+"="+b(e[2])+")");break;case "eval":e=b(e[1]);/^$\w+$/.test(e)?f("$!{"+e.slice(1)+"}"):f("#set($t = "+e+")$!{t}");break;case "text":f(e[1].replace(/\$/g,"$${dollar}").replace(/#/g,"$${sharp}"));break;
case "inc":f("#parse('"+e[1].replace(/\.\w+$/,".vm")+"')");break;default:throw Error("unknown stmt: "+e[0]);}}}function e(c,e){var a=b(c);e&&!e(c[0])&&(a="("+a+")");return a}function b(c){switch(c[0]){case "id":return g(c[1]);case "lit":return"string"==typeof c[1]?(c=c[1],c=-1==c.indexOf("'")?"'"+c+"'":"('"+c.split("'").join("'+\"'\"+'")+"')",c):String(c[1]);case ".":return e(c[1],w)+"."+c[2];case "[]":return e(c[1],w)+"["+b(c[2])+"]";case "!":return"!"+e(c[1],m);case "u-":if("u-"==c[1][0])throw Error("\u7981\u6b62\u4e24\u4e2a\u8d1f\u53f7\u8fde\u7528");
return"-"+e(c[1],m);case "*":case "/":case "%":return e(c[1],x)+c[0]+e(c[2],m);case "+":case "-":return e(c[1],y)+c[0]+" "+e(c[2],x);case "<":case ">":case "<=":case ">=":return e(c[1],z)+c[0]+e(c[2],y);case "==":case "!=":case "===":case "!==":return e(c[1],B)+c[0].slice(0,2)+e(c[2],z);case "&&":return e(c[1],D)+"&&"+e(c[2],B);case "||":return e(c[1],H)+"||"+e(c[2],D);default:throw Error("unknown expr: "+c[0]);}}var h=0,s="#set($dollar='$')#set($sharp='#')";d(a[1]);return s}A.prototype.toString=
function(){return"("+this.row+","+this.col+")"};var M=function(){var a=[[/\s+/],[/\/\/[^\r\n]*|\/\*[\s\S]*?\*\//],[/[A-Za-z_]\w*/,function(a){switch(a){case "true":case "false":return"boolean";case "set":case "include":return a;default:if(-1!=" abstract boolean break byte case catch char class const continue debugger default delete do double else enum export extends final finally float for function goto if implements import in instanceof int interface let long native new package private protected public return short static super switch synchronized this throw throws transient try typeof var void volatile while with yield ".indexOf(" "+
a+" ")||"null"==a)throw Error("Reserved: "+a+" "+F(this.source,this.index));return"realId"}}],[/"(?:[^"\\]|\\[\s\S])*"|'(?:[^'\\]|\\[\s\S])*'/,function(a){return"string"}],[/\d+(?:\.\d+)?(?:e-?\d+)?/,function(a){return"number"}],[function(a){a.sort().reverse();for(var f=0;f<a.length;++f)a[f]=a[f].replace(/[()*+?.[\]|]/g,"\\$&");return RegExp(a.join("|"))}("! % && ( ) * + - . / < <= = > >= [ ] || === !== == != ,".split(" ")),function(a){return/[*/%]/.test(a)?"mul":/[<>]/.test(a)?"rel":/[!=]=/.test(a)?
"eq":a}]];return J({"":[[/(?:(?!{{)[\s\S])+/,function(a){return"text"}],[/{{{/,function(a){this.pushState(a);return a}],[/{{(?:\/if|else|\/each|\/forin|\/raw)}}/,function(a){return a}],[/{{#raw}}/,function(a){this.pushState("raw");return a}],[/{{(?:#(?:if|each|forin)(?=\s))?/,function(a){this.pushState("{{");return a}]],raw:[[/(?:(?!{{\/raw}})[\s\S])+/,function(a){this.popState();return"rawtext"}]],"{{":a.concat([[/}}/,function(a){this.popState();return a}]]),"{{{":a.concat([[/}}}/,function(a){this.popState();
return a}]])})}(),L=function(){return function(a){function g(b,a){return h[b][a]}for(var f=a.nStart,d=a.tSymbols,e={},b=0;b<d.length;++b)e[d[b]]=b;var h=a.tAction,s=a.tGoto,c=a.tRules,k=a.tFuncs,m=a.actionIndex;m&&(g=function(b,a){var c=h[m[b]];return c[a]||c._});return function(b,a){function h(a){throw Error("Syntax error: "+b.getPos(m.index)+(a?"\n"+a:""));}var l=0,q=[0],m=b.scan(),u=[],t={get:function(a){return u[u.length+a]},set:function(a,b){u[u.length+a]=b}};if(a)for(var n in a)t[n]=a[n];for(;;)if(n=
g(l,e[m.tag]))if(0<n)q.push(l=n),u.push(m),m=b.scan();else if(0>n&&-32768<n){n=-n;var l=c[n],v=l.length-1;q.length-=v;l=s[q[q.length-1]][l[0]-f];q.push(l);k[n]?(n=k[n].apply(t,u.splice(u.length-v,v)),u.push(n)):1!=v&&u.splice(u.length-v,v,null)}else return m.tag!=d[0]&&h(),u[0];else{n=[];for(v=0;v<f;++v)g(l,v)&&n.push(d[v]);h("find "+m.tag+"\nexpect "+n.join(" "))}}}({nStart:36,tSymbols:"$ ! && ( ) + - . = [ ] boolean eq include mul number rawtext realId rel set string text {{ {{#each {{#forin {{#if {{#raw}} {{/each}} {{/forin}} {{/if}} {{/raw}} {{else}} {{{ || }} }}} AdditiveExpression EqualityExpression LogicalAndExpression LogicalOrExpression MemberExpression MultiplicativeExpression PrimaryExpression RelationalExpression UnaryExpression _text epsilon expr id name program statement statements texts".split(" "),
tAction:[{_:-2},{_:-32768},{21:3,22:4,23:5,24:6,25:7,26:8,32:9,_:-1},{_:-19},{1:13,3:14,6:15,11:16,13:17,15:18,17:19,19:20,20:21,_:0},{1:13,3:14,6:15,11:16,13:33,15:18,17:19,19:34,20:21,_:0},{16:38,_:0},{_:-17},{_:-3},{21:3,26:8,_:-13},{_:-26},{20:44,_:-23},{_:-25},{_:-21},{13:33,17:19,19:34,_:-22},{_:-24},{5:46,6:47,_:-40},{12:48,_:-44},{2:49,_:-46},{33:50,_:-48},{7:51,9:52,_:-32},{14:53,_:-37},{_:-29},{18:54,_:-42},{_:-35},{34:55,_:0},{_:-27},{_:-23},{_:-22},{13:33,17:19,19:34,20:56,_:0},{34:60,
_:0},{30:61,_:0},{35:62,_:0},{_:-18},{_:-33},{4:63,_:0},{_:-34},{34:64,_:0},{8:65,_:0},{13:33,17:19,19:34,_:0},{_:-11},{_:-15},{_:-16},{13:33,17:19,19:34,20:56,_:-49},{_:-20},{_:-12},{_:-28},{_:-14},{14:53,_:-38},{14:53,_:-39},{18:54,_:-43},{12:48,_:-45},{2:49,_:-47},{_:-30},{10:81,_:0},{_:-36},{5:46,6:47,_:-41},{34:82,_:0},{34:83,_:0},{34:84,_:0},{34:85,_:0},{21:3,22:4,23:5,24:6,25:7,26:8,29:86,31:87,32:9,_:0},{34:88,_:0},{_:-31},{_:-4},{_:-10},{21:3,22:4,23:5,24:6,25:7,26:8,27:94,32:9,_:0},{21:3,
22:4,23:5,24:6,25:7,26:8,27:95,32:9,_:0},{21:3,22:4,23:5,24:6,25:7,26:8,28:96,32:9,_:0},{21:3,22:4,23:5,24:6,25:7,26:8,28:97,32:9,_:0},{21:3,22:4,23:5,24:6,25:7,26:8,29:98,32:9,_:0},{_:-6},{_:-7},{_:-8},{_:-9},{_:-5}],actionIndex:[0,1,2,3,4,5,5,5,6,5,7,8,9,5,5,5,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,29,30,31,32,33,34,35,36,37,38,5,5,5,5,5,39,5,5,5,40,41,42,43,43,0,44,45,46,47,5,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,0,0,0,0,64,0,65,66,67,68,69,70,71,72,73,74,75],tGoto:[{14:1,
16:2},,{9:10,15:11,17:12},,{0:22,1:23,2:24,3:25,4:26,5:27,6:28,7:29,8:30,11:31,12:32},{0:22,1:23,2:24,3:25,4:26,5:27,6:28,7:29,8:30,11:35,12:32},{0:22,1:23,2:24,3:25,4:26,5:27,6:28,7:29,8:30,11:36,12:32},{0:22,1:23,2:24,3:25,4:26,5:27,6:28,7:29,8:30,11:37,12:32},,{0:22,1:23,2:24,3:25,4:26,5:27,6:28,7:29,8:30,11:39,12:32},,,{9:40},{4:26,6:28,8:41,12:32},{0:22,1:23,2:24,3:25,4:26,5:27,6:28,7:29,8:30,11:42,12:32},{4:26,6:28,8:43,12:32},,,,,{12:45},,,,,,,,,,,,,,,{12:57,13:58},{12:57,13:59},,,,,,,,,,{4:26,
5:66,6:28,8:30,12:32},{4:26,5:67,6:28,8:30,12:32},{0:22,4:26,5:27,6:28,7:68,8:30,12:32},{0:22,1:69,4:26,5:27,6:28,7:29,8:30,12:32},{0:22,1:23,2:70,4:26,5:27,6:28,7:29,8:30,12:32},{12:71},{0:22,1:23,2:24,3:25,4:26,5:27,6:28,7:29,8:30,11:72,12:32},{4:26,6:28,8:73,12:32},{0:74,4:26,5:27,6:28,8:30,12:32},,,,{10:75,12:57,13:76},{10:77,12:57,13:78},{16:79},,,,,{0:22,1:23,2:24,3:25,4:26,5:27,6:28,7:29,8:30,11:80,12:32},,,,,,,,,,,,,,{9:10,15:11,17:12},,,{16:89},{16:90},{16:91},{16:92},,{16:93},,{9:10,15:11,
17:12},{9:10,15:11,17:12},{9:10,15:11,17:12},{9:10,15:11,17:12},{9:10,15:11,17:12}],tRules:[[54,50],[50,52],[52],[52,52,51],[51,25,47,34,52,29],[51,25,47,34,52,31,52,29],[51,23,47,49,46,34,52,27],[51,23,47,49,49,34,52,27],[51,24,47,49,46,34,52,28],[51,24,47,49,49,34,52,28],[51,22,19,48,8,47,34],[51,22,47,34],[51,32,47,35],[51,53],[51,22,13,20,34],[49,20],[49,48],[53,45],[53,53,45],[45,21],[45,26,16,30],[48,17],[48,19],[48,13],[42,20],[42,15],[42,11],[42,48],[42,3,47,4],[40,42],[40,40,7,48],[40,40,
9,47,10],[44,40],[44,1,44],[44,6,44],[41,44],[41,41,14,44],[36,41],[36,36,5,41],[36,36,6,41],[43,36],[43,43,18,36],[37,43],[37,37,12,43],[38,37],[38,38,2,37],[39,38],[39,39,33,38],[47,39],[46]],tFuncs:function(){function a(a,b,d,f,c,g,m){return["each",b,g,f,d,!0]}function g(a,b,d,f,c,g,m){return["each",b,g,f,d,!1]}function f(a){return a.text}function d(a,b,d){return[b.text,a,d]}return[,function(a){return["prog",a]},function(){return[]},function(a,b){a.push(b);return a},function(a,b,d,f,c){return["if",
b,f]},function(a,b,d,f,c,g,m){return["if",b,f,g]},a,a,g,g,function(a,b,d,f,c,g){return["set",d.text,c]},function(a,b,d){return["eval",b,!1]},function(a,b,d){return["eval",b,!0]},function(a){return["text",a]},function(a,b,d,f){return["inc",G(d.text)]},function(a){return G(a.text)},f,function(a){return a},function(a,b){return a+b},f,function(a,b,d){return b.text},,,,function(a){return["lit",G(a.text)]},function(a){return["lit",+a.text]},function(a){return["lit","true"==a.text]},function(a){return["id",
a.text]},function(a,b,d){return b},,function(a,b,d){return[".",a,d.text]},function(a,b,d,f){return["[]",a,d]},,function(a,b){return["!",b]},function(a,b){return["u-",b]},,d,,d,d,,d,,d,,d,,d]}()})}();return{parse:E,compile:I,render:function(a,g){return I(a)(g)},compileToPhp:function(a){return N(E(a),!0)},compileToVM:function(a,g){return O(E(a))},version:"1.2.8"}}();"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=A:"function"==typeof define&&(define.amd||define.cmd)?
define(function(){return A}):"undefined"!=typeof KISSY&&KISSY.add(function(){return A});C&&(C.Crox=A)})(this);
