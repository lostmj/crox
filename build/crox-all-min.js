/*
 Crox v1.2.7
 https://github.com/thx/crox

 Released under the MIT license
 md5: 7c37208c1dbf841f3e94b327369a0663
*/
(function(D){var B=function(){function B(a,f){this.row=a;this.col=f}function G(a,f){var d=a.substring(0,f),c=d.match(/\r\n?|\n/g),g=1;c&&(g+=c.length);d=1+/[^\r\n]*$/.exec(d)[0].length;return new B(g,d)}function D(a){return'"'+a.replace(/[\x00-\x1f"\\\u2028\u2029]/g,function(f){switch(f){case '"':return'\\"';case "\\":return"\\\\";case "\b":return"\\b";case "\f":return"\\f";case "\n":return"\\n";case "\r":return"\\r";case "\t":return"\\t"}return"\\u"+("000"+f.charCodeAt(0).toString(16)).slice(-4)})+
'"'}function H(a){return eval(a)}function u(a){return a.replace(/^_+/,"$&$&")}function K(a){function f(b,e,s,g){this.tag=b;this.text=e;this.index=s;this.subMatches=g}function d(){}function c(b){for(var e=1,g=[],k=[1],f=[],a=0;a<b.length;++a)k.push(e+=RegExp("|"+b[a][0].source).exec("").length),f.push(b[a][1]||d),g.push("("+b[a][0].source+")");return[RegExp(g.join("|")+"|","g"),k,f]}f.prototype.toString=function(){return this.text};var g=a.$||"$",b={},k;for(k in a)"$"!=k.charAt(0)&&(b[k]=c(a[k]));
return function(k){var e=k.length,a=0,c=[""],d={text:"",index:0,source:k,pushState:function(b){c.push(b)},popState:function(){c.pop()},retract:function(b){a-=b}};return{scan:function(){do{var l;a:{var r=b[c[c.length-1]],p=r[0];p.lastIndex=a;l=p.exec(k);if(""==l[0]){if(a<e)throw Error("lexer error: "+G(k,a)+"\n"+k.slice(a,a+50));l=new f(g,"",a)}else{d.index=a;a=p.lastIndex;for(var p=r[1],q=0;q<p.length;++q)if(l[p[q]]){r=r[2][q].apply(d,l.slice(p[q],p[q+1]));l=new f(r,l[0],d.index,l.slice(p[q]+1,p[q+
1]));break a}l=void 0}}}while(null==l.tag);return l},getPos:function(b){return G(k,b)},reset:function(){a=0;c=[""]}}}}function x(a){var f;a:{switch(a){case "id":case "lit":f=!0;break a}f=!1}return f||"."==a||"[]"==a}function m(a){return x(a)||"!"==a||"u-"==a}function y(a){if(m(a))return!0;switch(a){case "*":case "/":case "%":return!0}return!1}function z(a){if(y(a))return!0;switch(a){case "+":case "-":return!0}return!1}function A(a){if(z(a))return!0;switch(a){case "<":case ">":case "<=":case ">=":return!0}return!1}
function C(a){if(A(a))return!0;switch(a){case "eq":case "ne":return!0}return!1}function E(a){return C(a)||"&&"==a}function I(a){return E(a)||"||"==a}function L(a,f,d){function c(b){e+=b}function g(b){for(var e=0;e<b.length;++e){var a=b[e];switch(a[0]){case "if":c("if("+k(a[1])+"){");g(a[2]);c("}");a[3]&&(c("else{"),g(a[3]),c("}"));break;case "each":var l=a[3]?u(a[3]):"_"+t++,r=k(a[1]);if(/^\w+$/.test(r))var p=r;else p="_"+t++,c("var "+p+" = "+r+";");a[5]?c("for(var "+l+"=0;"+l+"<"+p+".length;"+l+
"++){"):c("for(var "+l+" in "+p+") {");c("var "+a[4]+" = "+p+"["+l+"];");g(a[2]);c("}");break;case "set":c("var "+u(a[1])+"="+k(a[2])+";");break;case "eval":l=k(a[1]);/^\w+$/.test(l)?r=l:(r="_t",c("_t = "+l+";"));c("if("+r+" !=null)_s += "+((d?!a[2]:a[2])?f+"("+r+")":r)+";");break;case "text":c("_s += "+D(a[1])+";");break;case "inc":break;default:throw Error("unknown stmt: "+a[0]);}}}function b(b,a){var e=k(b);a&&!a(b[0])&&(e="("+e+")");return e}function k(a){switch(a[0]){case "id":return u(a[1]);
case "lit":return"string"==typeof a[1]?D(a[1]):String(a[1]);case ".":return b(a[1],x)+"."+a[2];case "[]":return b(a[1],x)+"["+k(a[2])+"]";case "!":return"!"+b(a[1],m);case "u-":return"- "+b(a[1],m);case "*":case "/":case "%":return b(a[1],y)+a[0]+b(a[2],m);case "+":case "-":return b(a[1],z)+a[0]+" "+b(a[2],y);case "<":case ">":case "<=":case ">=":return b(a[1],A)+a[0]+b(a[2],z);case "==":case "!=":case "===":case "!==":return b(a[1],C)+a[0]+b(a[2],A);case "&&":return b(a[1],E)+"&&"+b(a[2],C);case "||":return b(a[1],
I)+"||"+b(a[2],E);default:throw Error("unknown expr: "+a[0]);}}var t=0,e="";g(a[1]);return e}function F(a){return M(N(a))}function J(a,f){var d=F(a),c;f&&(c=f.htmlEncode);a=L(d,c||"_htmlEncode",!0);d="";c||(d="var _obj = { '<': '&lt;', '>': '&gt;', '&': '&amp;', '\"': '&quot;' };\tfunction _htmlEncode(s) {\t\treturn String(s).replace(/[<>&\"]/g, function(c) {\t\t\treturn _obj[c];\t\t});\t}");return Function("root",d+("var _t,_s = '';"+a+"return _s;"))}function O(a,f){function d(a){for(var c=0;c<a.length;++c){var e=
a[c];switch(e[0]){case "if":var s="if("+g(e[1])+"){";b+=s;d(e[2]);b+="}";e[3]&&(b+="else{",d(e[3]),b+="}");break;case "each":s="foreach("+g(e[1])+" as "+(e[3]?"$crox_"+u(e[3])+"=>":"")+("$crox_"+u(e[4]))+")";b+=s;b+="{";d(e[2]);b+="}";break;case "set":e="$crox_"+u(e[1])+" = "+g(e[2])+";";b+=e;break;case "eval":s=g(e[1]);b+="crox_echo("+s+", "+(f?!e[2]:e[2])+");";break;case "text":s=e[1];/<\?(?:php)?|\?>/.test(s)?(e="echo "+("'"+String(e[1]).replace(/['\\]/g,"\\$&")+"'")+";",b+=e):b+="?>"+s+"<?php ";
break;case "inc":e="include '"+e[1].replace(/\.\w+$/,".php")+"';";b+=e;break;default:throw Error("unknown stmt: "+e[0]);}}}function c(a,b){var e=g(a);b&&!b(a[0])&&(e="("+e+")");return e}function g(a){switch(a[0]){case "id":return"$crox_"+u(a[1]);case "lit":return"string"==typeof a[1]?"'"+String(a[1]).replace(/['\\]/g,"\\$&")+"'":String(a[1]);case ".":return c(a[1],x)+"->"+a[2];case "[]":return c(a[1],x)+"["+g(a[2])+"]";case "!":return"!crox_ToBoolean("+c(a[1],m)+")";case "u-":return"- "+c(a[1],m);
case "*":case "/":case "%":return c(a[1],y)+a[0]+c(a[2],m);case "+":return"crox_plus("+c(a[1],null)+", "+c(a[2],null)+")";case "-":return c(a[1],z)+"- "+c(a[2],y);case "<":case ">":case "<=":case ">=":return c(a[1],A)+a[0]+c(a[2],z);case "==":case "!=":case "===":case "!==":return c(a[1],C)+a[0]+c(a[2],A);case "&&":return"crox_logical_and("+c(a[1],null)+", "+c(a[2],null)+")";case "||":return"crox_logical_or("+c(a[1],null)+", "+c(a[2],null)+")";default:throw Error("unknown expr: "+a[0]);}}var b="";
d(a[1]);b="?>"==b.slice(0,2)?b.slice(2):"<?php "+b;return b="<?php "==b.slice(-6)?b.slice(0,-6):b+"?>"}function P(a){function f(a){return"$crox_"+u(a)}function d(a){t+=a}function c(a){for(var g=0;g<a.length;++g){var h=a[g];switch(h[0]){case "if":d("#if("+b(h[1])+")");c(h[2]);h[3]&&(d("#{else}"),c(h[3]));d("#{end}");break;case "each":++k;var t=b(h[1]);if(/^$\w+$/.test(t))var l=t;else l="$list"+(1==k?"":k),d("#set ("+l+" = "+t+")");h[5]?(d("#foreach("+f(h[4])+" in "+l+")"),h[3]&&d("#set("+f(h[3])+" = $velocityCount - 1)")):
h[3]?(d("#foreach("+f(h[3])+" in "+l+".keySet())"),d("#set("+f(h[4])+" ="+l+".get("+f(h[3])+"))")):d("#foreach("+f(h[4])+" in "+l+")");c(h[2]);d("#{end}");--k;break;case "set":d("#set ("+f(h[1])+"="+b(h[2])+")");break;case "eval":h=b(h[1]);/^$\w+$/.test(h)?d("$!{"+h.slice(1)+"}"):d("#set($t = "+h+")$!{t}");break;case "text":d(h[1].replace(/\$/g,"$${dollar}").replace(/#/g,"$${sharp}"));break;case "inc":d("#parse('"+h[1].replace(/\.\w+$/,".vm")+"')");break;default:throw Error("unknown stmt: "+h[0]);
}}}function g(a,g){var f=b(a);g&&!g(a[0])&&(f="("+f+")");return f}function b(a){switch(a[0]){case "id":return f(a[1]);case "lit":return"string"==typeof a[1]?(a=a[1],a=-1==a.indexOf("'")?"'"+a+"'":"('"+a.split("'").join("'+\"'\"+'")+"')",a):String(a[1]);case ".":return g(a[1],x)+"."+a[2];case "[]":return g(a[1],x)+"["+b(a[2])+"]";case "!":return"!"+g(a[1],m);case "u-":if("u-"==a[1][0])throw Error("\u7981\u6b62\u4e24\u4e2a\u8d1f\u53f7\u8fde\u7528");return"-"+g(a[1],m);case "*":case "/":case "%":return g(a[1],
y)+a[0]+g(a[2],m);case "+":case "-":return g(a[1],z)+a[0]+" "+g(a[2],y);case "<":case ">":case "<=":case ">=":return g(a[1],A)+a[0]+g(a[2],z);case "==":case "!=":case "===":case "!==":return g(a[1],C)+a[0].slice(0,2)+g(a[2],A);case "&&":return g(a[1],E)+"&&"+g(a[2],C);case "||":return g(a[1],I)+"||"+g(a[2],E);default:throw Error("unknown expr: "+a[0]);}}var k=0,t="#set($dollar='$')#set($sharp='#')";c(a[1]);return t}B.prototype.toString=function(){return"("+this.row+","+this.col+")"};var N=function(){var a=
[[/\s+/],[/[A-Za-z_]\w*/,function(a){switch(a){case "true":case "false":return"boolean";case "set":case "include":return a;default:if(-1!=" abstract boolean break byte case catch char class const continue debugger default delete do double else enum export extends final finally float for function goto if implements import in instanceof int interface let long native new package private protected public return short static super switch synchronized this throw throws transient try typeof var void volatile while with yield ".indexOf(" "+
a+" ")||"null"==a)throw Error("Reserved: "+a+" "+G(this.source,this.index));return"realId"}}],[/"(?:[^"\\]|\\[\s\S])*"|'(?:[^'\\]|\\[\s\S])*'/,function(a){return"string"}],[/\d+(?:\.\d+)?(?:e-?\d+)?/,function(a){return"number"}],[function(a){a.sort().reverse();for(var d=0;d<a.length;++d)a[d]=a[d].replace(/[()*+?.[\]|]/g,"\\$&");return RegExp(a.join("|"))}("! % && ( ) * + - . / < <= = > >= [ ] || === !== == !=".split(" ")),function(a){return/[!=]=/.test(a)?"eq":a}]];return K({"":[[/(?:(?!{{)[\s\S])+/,
function(a){return"text"}],[/{{{/,function(a){this.pushState(a);return a}],[/{{(?:\/if|else|\/each|\/forin|\/raw)}}/,function(a){return a}],[/{{#raw}}/,function(a){this.pushState("raw");return a}],[/{{(?:#(?:if|each|forin)(?=\s))?/,function(a){this.pushState("{{");return a}]],raw:[[/(?:(?!{{\/raw}})[\s\S])+/,function(a){this.popState();return"rawtext"}]],"{{":a.concat([[/}}/,function(a){this.popState();return a}]]),"{{{":a.concat([[/}}}/,function(a){this.popState();return a}]])})}(),M=function(){return function(a){function f(a,
b){return k[a][b]}for(var d=a.nStart,c=a.tSymbols,g={},b=0;b<c.length;++b)g[c[b]]=b;var k=a.tAction,t=a.tGoto,e=a.tRules,s=a.tFuncs,h=a.actionIndex;h&&(f=function(a,b){var g=k[h[a]];return g[b]||g._});return function(a,b){function k(b){throw Error("Syntax error: "+a.getPos(m.index)+(b?"\n"+b:""));}var h=0,q=[0],m=a.scan(),v=[],u={get:function(a){return v[v.length+a]},set:function(a,b){v[v.length+a]=b}};if(b)for(var n in b)u[n]=b[n];for(;;)if(n=f(h,g[m.tag]))if(0<n)q.push(h=n),v.push(m),m=a.scan();
else if(0>n&&-32768<n){n=-n;var h=e[n],w=h.length-1;q.length-=w;h=t[q[q.length-1]][h[0]-d];q.push(h);s[n]?(n=s[n].apply(u,v.splice(v.length-w,w)),v.push(n)):1!=w&&v.splice(v.length-w,w,null)}else return m.tag!=c[0]&&k(),v[0];else{n=[];for(w=0;w<d;++w)f(h,w)&&n.push(c[w]);k("find "+m.tag+"\nexpect "+n.join(" "))}}}({nStart:41,tSymbols:"$ ! % && ( ) * + - . / < <= = > >= [ ] boolean eq include number rawtext realId set string text {{ {{#each {{#forin {{#if {{#raw}} {{/each}} {{/forin}} {{/if}} {{/raw}} {{else}} {{{ || }} }}} AdditiveExpression EqualityExpression LogicalAndExpression LogicalOrExpression MemberExpression MultiplicativeExpression PrimaryExpression RelationalExpression UnaryExpression _text epsilon expr id name program statement statements texts".split(" "),
tAction:[{_:-2},{_:-32768},{26:3,27:4,28:5,29:6,30:7,31:8,37:9,_:-1},{_:-19},{1:13,4:14,8:15,18:16,20:17,21:18,23:19,24:20,25:21,_:0},{1:13,4:14,8:15,18:16,20:33,21:18,23:19,24:34,25:21,_:0},{22:38,_:0},{_:-17},{_:-3},{26:3,31:8,_:-13},{_:-26},{25:44,_:-23},{_:-25},{_:-21},{20:33,23:19,24:34,_:-22},{_:-24},{7:46,8:47,_:-42},{19:48,_:-49},{3:49,_:-51},{38:50,_:-53},{9:51,16:52,_:-32},{2:53,6:54,10:55,_:-39},{_:-29},{11:56,12:57,14:58,15:59,_:-47},{_:-35},{39:60,_:0},{_:-27},{_:-23},{_:-22},{20:33,
23:19,24:34,25:61,_:0},{39:65,_:0},{35:66,_:0},{40:67,_:0},{_:-18},{_:-33},{5:68,_:0},{_:-34},{39:69,_:0},{13:70,_:0},{20:33,23:19,24:34,_:0},{_:-11},{_:-15},{_:-16},{20:33,23:19,24:34,25:61,_:-54},{_:-20},{_:-12},{_:-28},{_:-14},{2:53,6:54,10:55,_:-40},{2:53,6:54,10:55,_:-41},{11:56,12:57,14:58,15:59,_:-48},{19:48,_:-50},{3:49,_:-52},{_:-30},{17:91,_:0},{_:-38},{_:-36},{_:-37},{7:46,8:47,_:-43},{7:46,8:47,_:-45},{7:46,8:47,_:-44},{7:46,8:47,_:-46},{39:92,_:0},{39:93,_:0},{39:94,_:0},{39:95,_:0},
{26:3,27:4,28:5,29:6,30:7,31:8,34:96,36:97,37:9,_:0},{39:98,_:0},{_:-31},{_:-4},{_:-10},{26:3,27:4,28:5,29:6,30:7,31:8,32:104,37:9,_:0},{26:3,27:4,28:5,29:6,30:7,31:8,32:105,37:9,_:0},{26:3,27:4,28:5,29:6,30:7,31:8,33:106,37:9,_:0},{26:3,27:4,28:5,29:6,30:7,31:8,33:107,37:9,_:0},{26:3,27:4,28:5,29:6,30:7,31:8,34:108,37:9,_:0},{_:-6},{_:-7},{_:-8},{_:-9},{_:-5}],actionIndex:[0,1,2,3,4,5,5,5,6,5,7,8,9,5,5,5,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,29,30,31,32,33,34,35,36,37,38,5,
5,5,5,5,39,5,5,5,5,5,5,5,5,40,41,42,43,43,0,44,45,46,47,5,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,0,0,0,0,69,0,70,71,72,73,74,75,76,77,78,79,80],tGoto:[{14:1,16:2},,{9:10,15:11,17:12},,{0:22,1:23,2:24,3:25,4:26,5:27,6:28,7:29,8:30,11:31,12:32},{0:22,1:23,2:24,3:25,4:26,5:27,6:28,7:29,8:30,11:35,12:32},{0:22,1:23,2:24,3:25,4:26,5:27,6:28,7:29,8:30,11:36,12:32},{0:22,1:23,2:24,3:25,4:26,5:27,6:28,7:29,8:30,11:37,12:32},,{0:22,1:23,2:24,3:25,4:26,5:27,6:28,7:29,8:30,11:39,12:32},
,,{9:40},{4:26,6:28,8:41,12:32},{0:22,1:23,2:24,3:25,4:26,5:27,6:28,7:29,8:30,11:42,12:32},{4:26,6:28,8:43,12:32},,,,,{12:45},,,,,,,,,,,,,,,{12:62,13:63},{12:62,13:64},,,,,,,,,,{4:26,5:71,6:28,8:30,12:32},{4:26,5:72,6:28,8:30,12:32},{0:22,4:26,5:27,6:28,7:73,8:30,12:32},{0:22,1:74,4:26,5:27,6:28,7:29,8:30,12:32},{0:22,1:23,2:75,4:26,5:27,6:28,7:29,8:30,12:32},{12:76},{0:22,1:23,2:24,3:25,4:26,5:27,6:28,7:29,8:30,11:77,12:32},{4:26,6:28,8:78,12:32},{4:26,6:28,8:79,12:32},{4:26,6:28,8:80,12:32},{0:81,
4:26,5:27,6:28,8:30,12:32},{0:82,4:26,5:27,6:28,8:30,12:32},{0:83,4:26,5:27,6:28,8:30,12:32},{0:84,4:26,5:27,6:28,8:30,12:32},,,,{10:85,12:62,13:86},{10:87,12:62,13:88},{16:89},,,,,{0:22,1:23,2:24,3:25,4:26,5:27,6:28,7:29,8:30,11:90,12:32},,,,,,,,,,,,,,,,,,,{9:10,15:11,17:12},,,{16:99},{16:100},{16:101},{16:102},,{16:103},,{9:10,15:11,17:12},{9:10,15:11,17:12},{9:10,15:11,17:12},{9:10,15:11,17:12},{9:10,15:11,17:12}],tRules:[[59,55],[55,57],[57],[57,57,56],[56,30,52,39,57,34],[56,30,52,39,57,36,57,
34],[56,28,52,54,51,39,57,32],[56,28,52,54,54,39,57,32],[56,29,52,54,51,39,57,33],[56,29,52,54,54,39,57,33],[56,27,24,53,13,52,39],[56,27,52,39],[56,37,52,40],[56,58],[56,27,20,25,39],[54,25],[54,53],[58,50],[58,58,50],[50,26],[50,31,22,35],[53,23],[53,24],[53,20],[47,25],[47,21],[47,18],[47,53],[47,4,52,5],[45,47],[45,45,9,53],[45,45,16,52,17],[49,45],[49,1,49],[49,8,49],[46,49],[46,46,6,49],[46,46,10,49],[46,46,2,49],[41,46],[41,41,7,46],[41,41,8,46],[48,41],[48,48,11,41],[48,48,14,41],[48,48,12,
41],[48,48,15,41],[42,48],[42,42,19,48],[43,42],[43,43,3,42],[44,43],[44,44,38,43],[52,44],[51]],tFuncs:function(){function a(a,b,c,d,e,f,h){return["each",b,f,d,c,!0]}function f(a,b,c,d,e,f,h){return["each",b,f,d,c,!1]}function d(a){return a.text}function c(a,b,c){return[b.text,a,c]}return[,function(a){return["prog",a]},function(){return[]},function(a,b){a.push(b);return a},function(a,b,c,d,e){return["if",b,d]},function(a,b,c,d,e,f,h){return["if",b,d,f]},a,a,f,f,function(a,b,c,d,e,f){return["set",
c.text,e]},function(a,b,c){return["eval",b,!1]},function(a,b,c){return["eval",b,!0]},function(a){return["text",a]},function(a,b,c,d){return["inc",H(c.text)]},function(a){return H(a.text)},d,function(a){return a},function(a,b){return a+b},d,function(a,b,c){return b.text},,,,function(a){return["lit",H(a.text)]},function(a){return["lit",+a.text]},function(a){return["lit","true"==a.text]},function(a){return["id",a.text]},function(a,b,c){return b},,function(a,b,c){return[".",a,c.text]},function(a,b,c,
d){return["[]",a,c]},,function(a,b){return["!",b]},function(a,b){return["u-",b]},,c,c,c,,c,c,,c,c,c,c,,c,,c,,c]}()})}();return{parse:F,compile:J,render:function(a,f){return J(a)(f)},compileToPhp:function(a){return O(F(a),!0)},compileToVM:function(a,f){return P(F(a))},version:"1.2.7"}}();"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=B:"function"==typeof define&&(define.amd||define.cmd)?define(function(){return B}):"undefined"!=typeof KISSY&&KISSY.add(function(){return B});
D&&(D.Crox=B)})(this);
