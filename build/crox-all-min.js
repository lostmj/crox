/*
 Crox v1.2.7
 https://github.com/thx/crox

 Released under the MIT license
 md5: 3aeed72312b5835ad4f2e8af35a34e67
*/
(function(B){var y=function(){function y(a,e){this.row=a;this.col=e}function E(a,e){var b=a.substring(0,e),g=b.match(/\r\n?|\n/g),c=1;g&&(c+=g.length);b=1+/[^\r\n]*$/.exec(b)[0].length;return new y(c,b)}function B(a){return'"'+a.replace(/[\x00-\x1f"\\\u2028\u2029]/g,function(e){switch(e){case '"':return'\\"';case "\\":return"\\\\";case "\b":return"\\b";case "\f":return"\\f";case "\n":return"\\n";case "\r":return"\\r";case "\t":return"\\t"}return"\\u"+("000"+e.charCodeAt(0).toString(16)).slice(-4)})+
'"'}function H(a){function e(d,c,f,e){this.tag=d;this.text=c;this.index=f;this.subMatches=e}function b(){}function g(d){for(var c=1,f=[],e=[1],z=[],a=0;a<d.length;++a)e.push(c+=RegExp("|"+d[a][0].source).exec("").length),z.push(d[a][1]||b),f.push("("+d[a][0].source+")");return[RegExp(f.join("|")+"|","g"),e,z]}e.prototype.toString=function(){return this.text};var c=a.$||"$",d={},h;for(h in a)"$"!=h.charAt(0)&&(d[h]=g(a[h]));return function(a){var b=a.length,f=0,h=[""],z={text:"",index:0,source:a,pushState:function(d){h.push(d)},
popState:function(){h.pop()},retract:function(d){f-=d}};return{scan:function(){do{var n;a:{var g=d[h[h.length-1]],l=g[0];l.lastIndex=f;n=l.exec(a);if(""==n[0]){if(f<b)throw Error("lexer error: "+E(a,f)+"\n"+a.slice(f,f+50));n=new e(c,"",f)}else{z.index=f;f=l.lastIndex;for(var l=g[1],q=0;q<l.length;++q)if(n[l[q]]){g=g[2][q].apply(z,n.slice(l[q],l[q+1]));n=new e(g,n[0],z.index,n.slice(l[q]+1,l[q+1]));break a}n=void 0}}}while(null==n.tag);return n},getPos:function(d){return E(a,d)},reset:function(){f=
0;h=[""]}}}}function u(a){var e;a:{switch(a){case "id":case "lit":e=!0;break a}e=!1}return e||"."==a||"[]"==a}function m(a){return u(a)||"!"==a||"u-"==a}function v(a){if(m(a))return!0;switch(a){case "*":case "/":case "%":return!0}return!1}function w(a){if(v(a))return!0;switch(a){case "+":case "-":return!0}return!1}function x(a){if(w(a))return!0;switch(a){case "<":case ">":case "<=":case ">=":return!0}return!1}function A(a){if(x(a))return!0;switch(a){case "eq":case "ne":return!0}return!1}function C(a){return A(a)||
"&&"==a}function F(a){return C(a)||"||"==a}function I(a,e){function b(d){k+=h+d+"\n"}function g(f){for(var c=0;c<f.length;++c){var a=f[c];switch(a[0]){case "if":b("if("+d(a[1])+"){");h+="\t";g(a[2]);h=h.slice(0,-1);b("}");a[3]&&(b("else{"),h+="\t",g(a[3]),h=h.slice(0,-1),b("}"));break;case "each":++r;var n=a[3]||"$i",k=d(a[1]);if(/^[$\w]+$/.test(k))var l=k;else l="$list"+(1==r?"":r),b("var "+l+" = "+k+";");a[5]?b("for(var "+n+"=0;"+n+"<"+l+".length;"+n+"++){"):b("for(var "+n+" in "+l+") {");h+="\t";
b("var "+a[4]+" = "+l+"["+n+"];");g(a[2]);h=h.slice(0,-1);b("}");--r;break;case "set":b("var "+a[1]+"="+d(a[2])+";");break;case "eval":n=d(a[1]);b("var $t = "+n+";if($t!=null)$s += "+(a[2]?e+"($t)":"$t")+";");break;case "text":b("$s += "+B(a[1])+";");break;case "inc":break;default:throw Error("unknown stmt: "+a[0]);}}}function c(f,a){var c=d(f);a&&!a(f[0])&&(c="("+c+")");return c}function d(f){switch(f[0]){case "id":return f[1];case "lit":return"string"==typeof f[1]?B(f[1]):String(f[1]);case ".":return c(f[1],
u)+"."+f[2];case "[]":return c(f[1],u)+"["+d(f[2])+"]";case "!":return"!"+c(f[1],m);case "u-":return"- "+c(f[1],m);case "*":case "/":case "%":return c(f[1],v)+f[0]+c(f[2],m);case "+":case "-":return c(f[1],w)+f[0]+" "+c(f[2],v);case "<":case ">":case "<=":case ">=":return c(f[1],x)+f[0]+c(f[2],w);case "==":case "!=":case "===":case "!==":return c(f[1],A)+f[0]+c(f[2],x);case "&&":return c(f[1],C)+"&&"+c(f[2],A);case "||":return c(f[1],F)+"||"+c(f[2],C);default:throw Error("unknown expr: "+f[0]);}}
var h="\t",r=0,k="";g(a[1]);return k}function D(a){return J(K(a))}function G(a,e){var b=D(a),g;e&&(g=e.htmlEncode);var b=I(b,g||"$htmlEncode"),c="";g||(c+="var obj = { '<': '&lt;', '>': '&gt;', '&': '&amp;', '\"': '&quot;' };\n\tfunction $htmlEncode(s) {\n\t\treturn String(s).replace(/[<>&\"]/g, function(c) {\n\t\t\treturn obj[c];\n\t\t});\n\t}");c=c+"var $s = '';"+b;c+="return $s;";return Function("root",c)}function L(a){function e(d){for(var a=0;a<d.length;++a){var b=d[a];switch(b[0]){case "if":var k=
"if("+g(b[1])+"){";c+=k;e(b[2]);c+="}";b[3]&&(c+="else{",e(b[3]),c+="}");break;case "each":k=b[3]?"$crox_"+b[3]+"=>":"";k="foreach("+g(b[1])+" as "+k+"$crox_"+b[4]+")";c+=k;c+="{";e(b[2]);c+="}";break;case "set":b="$crox_"+b[1]+" = "+g(b[2])+";";c+=b;break;case "eval":k=g(b[1]);c+="crox_echo("+k+", "+!!b[2]+");";break;case "text":k=b[1];/<\?(?:php)?|\?>/.test(k)?(b="echo "+("'"+String(b[1]).replace(/['\\]/g,"\\$&")+"'")+";",c+=b):c+="?>"+k+"<?php ";break;case "inc":b="include '"+b[1].replace(/\.\w+$/,
".php")+"';";c+=b;break;default:throw Error("unknown stmt: "+b[0]);}}}function b(d,a){var b=g(d);a&&!a(d[0])&&(b="("+b+")");return b}function g(d){switch(d[0]){case "id":return"$crox_"+d[1];case "lit":return"string"==typeof d[1]?"'"+String(d[1]).replace(/['\\]/g,"\\$&")+"'":String(d[1]);case ".":return b(d[1],u)+"->"+d[2];case "[]":return b(d[1],u)+"["+g(d[2])+"]";case "!":return"!crox_ToBoolean("+b(d[1],m)+")";case "u-":return"- "+b(d[1],m);case "*":case "/":case "%":return b(d[1],v)+d[0]+b(d[2],
m);case "+":return"crox_plus("+b(d[1],null)+", "+b(d[2],null)+")";case "-":return b(d[1],w)+"- "+b(d[2],v);case "<":case ">":case "<=":case ">=":return b(d[1],x)+d[0]+b(d[2],w);case "==":case "!=":case "===":case "!==":return b(d[1],A)+d[0]+b(d[2],x);case "&&":return"crox_logical_and("+b(d[1],null)+", "+b(d[2],null)+")";case "||":return"crox_logical_or("+b(d[1],null)+", "+b(d[2],null)+")";default:throw Error("unknown expr: "+d[0]);}}var c="";e(a[1]);c="?>"==c.slice(0,2)?c.slice(2):"<?php "+c;return c=
"<?php "==c.slice(-6)?c.slice(0,-6):c+"?>"}function M(a,e){function b(d){k+=d}function g(d){for(var a=0;a<d.length;++a){var e=d[a];switch(e[0]){case "if":b("#if("+h(e[1])+")");g(e[2]);e[3]&&(b("#{else}"),g(e[3]));b("#{end}");break;case "each":++r;var k="$list"+(1==r?"":r);b("#set ("+k+" = "+h(e[1])+")");e[5]?(b("#foreach($_"+e[4]+" in "+k+")"),e[3]&&b("#set($_"+e[3]+" = $velocityCount - 1)")):e[3]?(b("#foreach($_"+e[3]+" in "+k+".keySet())"),b("#set($_"+e[4]+" ="+k+".get($_"+e[3]+"))")):b("#foreach($_"+
e[4]+" in "+k+")");g(e[2]);b("#{end}");--r;break;case "set":b("#set ($"+c(e[1])+"="+h(e[2])+")");break;case "eval":e=h(e[1]);/^\$([\w-]+)$/.test(e)?b("$!{"+RegExp.$1+"}"):b("#set($t = "+e+")$!{t}");break;case "text":b(e[1].replace(/\$/g,"$${dollar}").replace(/#/g,"$${sharp}"));break;case "inc":b("#parse('"+e[1].replace(/\.\w+$/,".vm")+"')");break;default:throw Error("unknown stmt: "+e[0]);}}}function c(d){return"root"==d?"crox_root":"_"+d}function d(d,a){var e=h(d);a&&!a(d[0])&&(e="("+e+")");return e}
function h(a){switch(a[0]){case "id":return"$"+c(a[1]);case "lit":return"string"==typeof a[1]?(a=a[1],a=-1==a.indexOf("'")?"'"+a+"'":"('"+a.split("'").join("'+\"'\"+'")+"')",a):String(a[1]);case ".":return d(a[1],u)+"."+a[2];case "[]":return d(a[1],u)+"["+h(a[2])+"]";case "!":return"!"+d(a[1],m);case "u-":if("u-"==a[1][0])throw Error("\u7981\u6b62\u4e24\u4e2a\u8d1f\u53f7\u8fde\u7528");return"-"+d(a[1],m);case "*":case "/":case "%":return d(a[1],v)+a[0]+d(a[2],m);case "+":case "-":return d(a[1],w)+
a[0]+" "+d(a[2],v);case "<":case ">":case "<=":case ">=":return d(a[1],x)+a[0]+d(a[2],w);case "==":case "!=":case "===":case "!==":return d(a[1],A)+a[0].slice(0,2)+d(a[2],x);case "&&":return d(a[1],C)+"&&"+d(a[2],A);case "||":return d(a[1],F)+"||"+d(a[2],C);default:throw Error("unknown expr: "+a[0]);}}e||(e="\r\n");var r=0,k="#set($dollar='$')#set($sharp='#')";g(a[1]);return k}y.prototype.toString=function(){return"("+this.row+","+this.col+")"};var K=function(){var a=[[/\s+/,function(){return null}],
[/[A-Za-z_]\w*/,function(a){switch(a){case "true":case "false":return"boolean";case "set":case "include":return a;default:if(-1!=" abstract boolean break byte case catch char class const continue debugger default delete do double else enum export extends final finally float for function goto if implements import in instanceof int interface let long native new package private protected public return short static super switch synchronized this throw throws transient try typeof var void volatile while with yield ".indexOf(" "+
a+" ")||"null"==a)throw Error("Reserved: "+a+" "+E(this.source,this.index));return"realId"}}],[/"(?:[^"\\]|\\[\s\S])*"|'(?:[^'\\]|\\[\s\S])*'/,function(a){return"string"}],[/\d+(?:\.\d+)?(?:e-?\d+)?/,function(a){return"number"}],[function(a){a.sort().reverse();for(var b=0;b<a.length;++b)a[b]=a[b].replace(/[()*+?.[\]|]/g,"\\$&");return RegExp(a.join("|"))}("! % && ( ) * + - . / < <= = > >= [ ] || === !== == !=".split(" ")),function(a){switch(a){case "==":case "===":case "!=":case "!==":return"eq";
default:return a}}]];return H({"":[[/(?:(?!{{)[\s\S])+/,function(a){return"{{"==a.substring(0,2)?(this.pushState(a),a):"text"}],[/{{{/,function(a){this.pushState(a);return a}],[/{{(?:\/if|else|\/each|\/forin|\/raw)}}/,function(a){return a}],[/{{#raw}}/,function(a){this.pushState("raw");return a}],[/{{(?:#(?:if|each|forin)(?=\s))?/,function(a){this.pushState("{{");return a}]],raw:[[/(?:(?!{{\/raw}})[\s\S])+/,function(a){this.popState();return"rawtext"}]],"{{":a.concat([[/}}/,function(a){this.popState();
return a}]]),"{{{":a.concat([[/}}}/,function(a){this.popState();return a}]])})}(),J=function(){return function(a){function e(a,d){return h[a][d]}for(var b=a.nStart,g=a.tSymbols,c={},d=0;d<g.length;++d)c[g[d]]=d;var h=a.tAction,r=a.tGoto,k=a.tRules,f=a.tFuncs,m=a.actionIndex;m&&(e=function(a,d){var b=h[m[a]];return b[d]||b._});return function(a,d){function h(d){throw Error("Syntax error: "+a.getPos(m.index)+(d?"\n"+d:""));}var l=0,q=[0],m=a.scan(),s=[],u={get:function(a){return s[s.length+a]},set:function(a,
d){s[s.length+a]=d}};if(d)for(var p in d)u[p]=d[p];for(;;)if(p=e(l,c[m.tag]))if(0<p)q.push(l=p),s.push(m),m=a.scan();else if(0>p&&-32768<p){p=-p;var l=k[p],t=l.length-1;q.length-=t;l=r[q[q.length-1]][l[0]-b];q.push(l);f[p]?(p=f[p].apply(u,s.splice(s.length-t,t)),s.push(p)):1!=t&&s.splice(s.length-t,t,null)}else return m.tag!=g[0]&&h(),s[0];else{p=[];for(t=0;t<b;++t)e(l,t)&&p.push(g[t]);h("find "+m.tag+"\nexpect "+p.join(" "))}}}({nStart:41,tSymbols:"$ ! % && ( ) * + - . / < <= = > >= [ ] boolean eq include number rawtext realId set string text {{ {{#each {{#forin {{#if {{#raw}} {{/each}} {{/forin}} {{/if}} {{/raw}} {{else}} {{{ || }} }}} AdditiveExpression EqualityExpression LogicalAndExpression LogicalOrExpression MemberExpression MultiplicativeExpression PrimaryExpression RelationalExpression UnaryExpression _text epsilon expr id name program statement statements texts".split(" "),
tAction:[{_:-2},{_:-32768},{26:3,27:4,28:5,29:6,30:7,31:8,37:9,_:-1},{_:-19},{1:13,4:14,8:15,18:16,20:17,21:18,23:19,24:20,25:21,_:0},{1:13,4:14,8:15,18:16,20:33,21:18,23:19,24:34,25:21,_:0},{22:38,_:0},{_:-17},{_:-3},{26:3,31:8,_:-13},{_:-26},{25:44,_:-23},{_:-25},{_:-21},{20:33,23:19,24:34,_:-22},{_:-24},{7:46,8:47,_:-42},{19:48,_:-49},{3:49,_:-51},{38:50,_:-53},{9:51,16:52,_:-32},{2:53,6:54,10:55,_:-39},{_:-29},{11:56,12:57,14:58,15:59,_:-47},{_:-35},{39:60,_:0},{_:-27},{_:-23},{_:-22},{20:33,
23:19,24:34,25:61,_:0},{39:65,_:0},{35:66,_:0},{40:67,_:0},{_:-18},{_:-33},{5:68,_:0},{_:-34},{39:69,_:0},{13:70,_:0},{20:33,23:19,24:34,_:0},{_:-11},{_:-15},{_:-16},{20:33,23:19,24:34,25:61,_:-54},{_:-20},{_:-12},{_:-28},{_:-14},{2:53,6:54,10:55,_:-40},{2:53,6:54,10:55,_:-41},{11:56,12:57,14:58,15:59,_:-48},{19:48,_:-50},{3:49,_:-52},{_:-30},{17:91,_:0},{_:-38},{_:-36},{_:-37},{7:46,8:47,_:-43},{7:46,8:47,_:-45},{7:46,8:47,_:-44},{7:46,8:47,_:-46},{39:92,_:0},{39:93,_:0},{39:94,_:0},{39:95,_:0},
{26:3,27:4,28:5,29:6,30:7,31:8,34:96,36:97,37:9,_:0},{39:98,_:0},{_:-31},{_:-4},{_:-10},{26:3,27:4,28:5,29:6,30:7,31:8,32:104,37:9,_:0},{26:3,27:4,28:5,29:6,30:7,31:8,32:105,37:9,_:0},{26:3,27:4,28:5,29:6,30:7,31:8,33:106,37:9,_:0},{26:3,27:4,28:5,29:6,30:7,31:8,33:107,37:9,_:0},{26:3,27:4,28:5,29:6,30:7,31:8,34:108,37:9,_:0},{_:-6},{_:-7},{_:-8},{_:-9},{_:-5}],actionIndex:[0,1,2,3,4,5,5,5,6,5,7,8,9,5,5,5,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,29,30,31,32,33,34,35,36,37,38,5,
5,5,5,5,39,5,5,5,5,5,5,5,5,40,41,42,43,43,0,44,45,46,47,5,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,0,0,0,0,69,0,70,71,72,73,74,75,76,77,78,79,80],tGoto:[{14:1,16:2},,{9:10,15:11,17:12},,{0:22,1:23,2:24,3:25,4:26,5:27,6:28,7:29,8:30,11:31,12:32},{0:22,1:23,2:24,3:25,4:26,5:27,6:28,7:29,8:30,11:35,12:32},{0:22,1:23,2:24,3:25,4:26,5:27,6:28,7:29,8:30,11:36,12:32},{0:22,1:23,2:24,3:25,4:26,5:27,6:28,7:29,8:30,11:37,12:32},,{0:22,1:23,2:24,3:25,4:26,5:27,6:28,7:29,8:30,11:39,12:32},
,,{9:40},{4:26,6:28,8:41,12:32},{0:22,1:23,2:24,3:25,4:26,5:27,6:28,7:29,8:30,11:42,12:32},{4:26,6:28,8:43,12:32},,,,,{12:45},,,,,,,,,,,,,,,{12:62,13:63},{12:62,13:64},,,,,,,,,,{4:26,5:71,6:28,8:30,12:32},{4:26,5:72,6:28,8:30,12:32},{0:22,4:26,5:27,6:28,7:73,8:30,12:32},{0:22,1:74,4:26,5:27,6:28,7:29,8:30,12:32},{0:22,1:23,2:75,4:26,5:27,6:28,7:29,8:30,12:32},{12:76},{0:22,1:23,2:24,3:25,4:26,5:27,6:28,7:29,8:30,11:77,12:32},{4:26,6:28,8:78,12:32},{4:26,6:28,8:79,12:32},{4:26,6:28,8:80,12:32},{0:81,
4:26,5:27,6:28,8:30,12:32},{0:82,4:26,5:27,6:28,8:30,12:32},{0:83,4:26,5:27,6:28,8:30,12:32},{0:84,4:26,5:27,6:28,8:30,12:32},,,,{10:85,12:62,13:86},{10:87,12:62,13:88},{16:89},,,,,{0:22,1:23,2:24,3:25,4:26,5:27,6:28,7:29,8:30,11:90,12:32},,,,,,,,,,,,,,,,,,,{9:10,15:11,17:12},,,{16:99},{16:100},{16:101},{16:102},,{16:103},,{9:10,15:11,17:12},{9:10,15:11,17:12},{9:10,15:11,17:12},{9:10,15:11,17:12},{9:10,15:11,17:12}],tRules:[[59,55],[55,57],[57],[57,57,56],[56,30,52,39,57,34],[56,30,52,39,57,36,57,
34],[56,28,52,54,51,39,57,32],[56,28,52,54,54,39,57,32],[56,29,52,54,51,39,57,33],[56,29,52,54,54,39,57,33],[56,27,24,53,13,52,39],[56,27,52,39],[56,37,52,40],[56,58],[56,27,20,25,39],[54,25],[54,53],[58,50],[58,58,50],[50,26],[50,31,22,35],[53,23],[53,24],[53,20],[47,25],[47,21],[47,18],[47,53],[47,4,52,5],[45,47],[45,45,9,53],[45,45,16,52,17],[49,45],[49,1,49],[49,8,49],[46,49],[46,46,6,49],[46,46,10,49],[46,46,2,49],[41,46],[41,41,7,46],[41,41,8,46],[48,41],[48,48,11,41],[48,48,14,41],[48,48,12,
41],[48,48,15,41],[42,48],[42,42,19,48],[43,42],[43,43,3,42],[44,43],[44,44,38,43],[52,44],[51]],tFuncs:function(){function a(a,b,c,e,f,g,m){return["each",b,g,e,c,!0]}function e(a,b,c,e,f,g,m){return["each",b,g,e,c,!1]}function b(a){return a.text}function g(a){return["lit",eval(a.text)]}function c(a,b,c){return[b.text,a,c]}return[,function(a){return["prog",a]},function(){return[]},function(a,b){a.push(b);return a},function(a,b,c,e,f){return["if",b,e]},function(a,b,c,e,f,g,m){return["if",b,e,g]},a,
a,e,e,function(a,b,c,e,f,g){return["set",c.text,f]},function(a,b,c){return["eval",b,!0]},function(a,b,c){return["eval",b,!1]},function(a){return["text",a]},function(a,b,c,e){return["inc",eval(c.text)]},function(a){return eval(a.text)},b,function(a){return a},function(a,b){return a+b},b,function(a,b,c){return b.text},,,,g,g,function(a){return["lit","true"==a.text]},function(a){return["id",a.text]},function(a,b,c){return b},,function(a,b,c){return[".",a,c.text]},function(a,b,c,e){return["[]",a,c]},
,function(a,b){return["!",b]},function(a,b){return["u-",b]},,c,c,c,,c,c,,c,c,c,c,,c,,c,,c]}()})}();return{parse:D,compile:G,render:function(a,e){return G(a)(e)},compileToPhp:function(a){return L(D(a))},compileToVM:function(a,e){return M(D(a))},version:"1.2.7"}}();"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=y:"function"==typeof define&&(define.amd||define.cmd)?define(function(){return y}):"undefined"!=typeof KISSY&&KISSY.add(function(){return y});B&&(B.Crox=y)})(this);
